<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!--doc-version-default-links-begin-->
<!-- Please do not edit the below line(s) manually, see DocumentVersioning.qs (151018182358), version 1.0.0.1-->
<!-- Bootstrap core CSS -->
<link href="../../bootstrap/css/bootstrap.min.css" type="text/css" rel="stylesheet"/>
<!-- Bootstrap theme -->
<link href="../../bootstrap/css/bootstrap-theme.min.css" type="text/css" rel="stylesheet"/>
<!-- Code-Prettify -->
<link href="../../google-code-prettify/prettify.css" type="text/css" rel="stylesheet"/>
<script src="../../google-code-prettify/prettify.js" type="text/javascript"></script>
<!-- Custom styles for this template -->
<link href="../../css/custom_theme.css" type="text/css" rel="stylesheet"/>
<!--doc-version-default-links-end-->
<!--doc-version-title-begin-->
<!-- Please do not edit the below line(s) manually, see DocumentVersioning.qs (151018182358), version 1.0.0.1-->
<title>Signal-Slot Connections v1.0</title>
<!--doc-version-title-end-->
</head>
<body>
    <div class="container">

<!--doc-version-default-header-begin-->
<!-- Please do not edit the below line(s) manually, see DocumentVersioning.qs (151018182358), version 1.0.0.1-->
	<div class="doc-header">
		<div class="alert alert-info" role="alert">
			<h1>Signal-Slot Connections</h1>
			<div class="row">
				<div class="col-md-4"><p><strong>Document version:</strong>1.0</p></div>
				<div class="col-md-4"><p><strong>Author(s):</strong>Sven Gijsen</p></div>
				<div class="col-md-4"><p><strong>Date:</strong>July 2015</p></div>
			</div>
		</div>
	</div>
<!--doc-version-default-header-end-->
    <h2>
        Introduction</h2>
		<p>
        The BrainStim script engine supports the Qt-style signal and slot 
		connections, see
		<a href="http://doc.qt.io/qt-5/signalsandslots.html" target="_blank">
		this online document</a>. Signals and slots are used for communication 
		between objects. This is an important feature for the script engine 
		because it can make the script very flexible and powerfull. It allows 
		the script to dynamically connect/disconnect various objects to each 
		other by connecting their signals and slots. These objects can then 
		communicate to each other outside the main program loop.</p>
		<p>
        Signals are emitted by an object when its internal state has changed in 
		some way that might be interesting to another object. When a signal is 
		emitted, the slots (or even signals) connected to it are usually 
		executed immediately, just like a normal function call. When this 
		happens, the signals and slots mechanism is totally independent of the 
		main program loop.</p>
		<p>
        Slots can be custom defined script functions or member functions from 
		script objects. It is currently not possible to define a new signal in 
		the script, this means that all signals must be defined in their 
		underlying C++ object classes. The following example shows how 
		Signal/slots connection can be used inside the script to pass a signal 
		(an event) from one object to another slot (a script function). If 
		several slots are connected to one signal, the slots will be executed 
		one after the other, in the order they have been connected, when the 
		signal is emitted.</p>
		<h2>
        Example</h2>
		<p>
		Let's try to create a Signal-Slot connection and make use of it in the 
		script</p>
    	<ol>
			<li>Start BrainStim.</li>
			<li>Open the file <em>SignalSlotMechanism.qs</em> that is located in the  
			<a href="../GettingStartedGuide/GettingStartedGuide.html#MainProgramdirectory">Main Program Directory</a> subfolder 
		\<em>Examples\BrainStim\QtScript SignalSlotMechanism\</em></li>
			<li>Examine the script<br />We see that first a custom
			<a href="http://doc.qt.io/qt-5/qdialog.html" target="_blank">QDialog</a> 
		is created with two
			<a href="http://doc.qt.io/qt-5/qpushbutton.html" target="_blank">QPushbutton</a> controls placed on a
			<a href="http://doc.qt.io/qt-5/qgridlayout.html" target="_blank">QGridLayout</a>. Just before the custom dialog is shown some Signal/Slot 
		connection are made using this syntax:<br />
			<table class="codeframe">
				<tr>
					<td>
					<pre class="prettyprint"><code class="language-js">&lt;objectname&gt;.&lt;signalname&gt;.connect(&lt;slotname&gt;);</code></pre>
					</td>
				</tr>
			</table>
			<p>like:</p>
			<table class="codeframe">
				<tr>
					<td>
					<pre class="prettyprint"><code class="language-js">cClickButton.clicked.connect(onClickButtonClicked);</code></pre>
					</td>
				</tr>
			</table>
			<p>This connects the
			<a href="http://doc.qt.io/qt-5/qabstractbutton.html#clicked" target="_blank">signal clicked()</a> from the
			<a href="http://doc.qt.io/qt-5/qpushbutton.html" target="_blank">QPushbutton</a> cClickButton to a 
			<a href="FunctionsAndIncludes.html">local defined function</a> slot onClickButtonClicked().<br />Then there's also a Signal/Slot connection made for the cExitButton
			<a href="http://doc.qt.io/qt-5/qpushbutton.html" target="_blank">QPushbutton</a> handling.</p>
			<table class="codeframe">
				<tr>
					<td>
					<pre class="prettyprint"><code class="language-js">cExitButton.clicked.connect(onExitButtonClicked);</code></pre>
					</td>
				</tr>
			</table>
			<p>After all connections are made the we see that the dialog is shown 
		and the main script loop ends, no more processing to be done. If one of 
		the two buttons is pressed then the corresponding connected function 
		slot is executed. When the <em>cExitButton</em> is clicked then the <em>CleanupScript()</em> function slot is executed for the
			<a href="GarbageCollection.html">garbage collection</a> so the script 
		can exit.</p>
			<p><strong>Important! </strong>Aside from connecting a <em>clicked()</em> signal to a function 
		slot <em>onExitButtonClicked()</em> for handling the exit of the script, 
		like described above here, there's also something else implemented in 
		the example script for the handling of when a user closes the dialog 
		manually (by clicking the <kbd>x</kbd> in the top right border of the 
		dialog). This is done by overriding a
			<a href="https://en.wikipedia.org/wiki/Virtual_function" target="_blank">virtual function</a> from the 
			<em>cDialog</em> (<a href="http://doc.qt.io/qt-5/qdialog.html" target="_blank">QDialog</a>) 
		named <em>
			<a href="http://doc.qt.io/qt-5/qdialog.html#closeEvent" target="_blank">closeEvent()</a></em>. Because this is a virtual function we can 
		override it with our own custom implementation, we do that in the 
		example script like:</p>
			<table class="codeframe">
				<tr>
					<td>
					<pre class="prettyprint"><code class="language-js">cDialog.closeEvent = function()
{
    Log("cDialog closeEvent() detected!");
    CleanupScript();
}</code></pre>
					</td>
				</tr>
			</table>
			<p>By overriding this virtual function like this we can make sure 
			that whenever the user manually closes our custom dialog the script 
			is then finalized.</p>
			<p>Finally a function named <em>CleanupScript()</em> is used for the 
			implementation of the correct <a href="GarbageCollection.html">
			garbage collection</a> handling so the script can end successfully.<br />
			Inside this <em>CleanupScript()</em> function we see that all 
			Signal/Slot connections are again disconnected using the following 
			syntax:
			</p>
			<table class="codeframe">
				<tr>
					<td>
					<pre class="prettyprint"><code class="language-js">&lt;objectname&gt;.&lt;signalname&gt;.disconnect(&lt;slotname&gt;);</code></pre>
					</td>
				</tr>
			</table>

			</li>
			<li>
			<p>Execute (press the <kbd>F5</kbd> key) the QtScript code and watch 
			what happens when you click the buttons of the custom dialog, also 
			try to close the dialog by clicking the <kbd>x</kbd> in the top 
			right border of the dialog. Verify that everything works by watching the<a href="../GettingStartedGuide/GettingStartedGuide.html#UserInterface"> 
			'default' OutputLog tab</a> messages while trying.</p>
			</li>
		</ol>
   </div>
<!--doc-version-default-footer-begin-->
<!-- Please do not edit the below line(s) manually, see DocumentVersioning.qs (151018182358), version 1.0.0.1-->
	<script type="text/javascript">document.body.onload = function() {prettyPrint()};</script>
<!--doc-version-default-footer-end-->
 </body>
</html>
