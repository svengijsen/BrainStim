<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ExperimentManager script class: ExperimentTimer.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ExperimentManager script class
   &#160;<span id="projectnumber">1.0.0.1</span>
   </div>
   <div id="projectbrief">The Experiment Manager script class reference.</div>
  </td>
  
  
  
   
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
</div>
<div class="header">
  <div class="headertitle">
<div class="title">ExperimentTimer.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//ExperimentManagerplugin</span>
<a name="l00002"></a>00002 <span class="comment">//Copyright (C) 2015  Sven Gijsen and Michael Luehrs</span>
<a name="l00003"></a>00003 <span class="comment">//</span>
<a name="l00004"></a>00004 <span class="comment">//This file is part of BrainStim.</span>
<a name="l00005"></a>00005 <span class="comment">//BrainStim is free software: you can redistribute it and/or modify</span>
<a name="l00006"></a>00006 <span class="comment">//it under the terms of the GNU General Public License as published by</span>
<a name="l00007"></a>00007 <span class="comment">//the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00008"></a>00008 <span class="comment">//(at your option) any later version.</span>
<a name="l00009"></a>00009 <span class="comment">//</span>
<a name="l00010"></a>00010 <span class="comment">//This program is distributed in the hope that it will be useful,</span>
<a name="l00011"></a>00011 <span class="comment">//but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment">//MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00013"></a>00013 <span class="comment">//GNU General Public License for more details.</span>
<a name="l00014"></a>00014 <span class="comment">//</span>
<a name="l00015"></a>00015 <span class="comment">//You should have received a copy of the GNU General Public License</span>
<a name="l00016"></a>00016 <span class="comment">//along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00017"></a>00017 <span class="comment">//</span>
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="preprocessor">#ifndef EXPERIMENTTIMER_H</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span><span class="preprocessor">#define EXPERIMENTTIMER_H</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;QObject&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;QtScript&gt;</span>
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="preprocessor">#ifdef WIN32   // Windows 32 system specific</span>
<a name="l00027"></a>00027 <span class="preprocessor"></span><span class="preprocessor">#include &lt;windows.h&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#else</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span><span class="preprocessor">#ifdef WIN64   // Windows 64 system specific</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">#include &lt;windows.h&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#else          // Unix based system specific</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span><span class="preprocessor">#include &lt;sys/time.h&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#endif          </span>
<a name="l00034"></a>00034 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span>
<a name="l00037"></a>00037 <span class="comment">//#include &lt;sys/time.h&gt;</span>
<a name="l00038"></a>00038 <span class="comment">//#endif</span>
<a name="l00039"></a>00039 
<a name="l00041"></a>00041 
<a name="l00044"></a><a class="code" href="class_experiment_timer.html">00044</a> <span class="keyword">class </span><a class="code" href="class_experiment_timer.html" title="The ExperimentTimer class.">ExperimentTimer</a> : <span class="keyword">public</span> QObject
<a name="l00045"></a>00045 {
<a name="l00046"></a>00046         Q_OBJECT
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 signals:
<a name="l00050"></a>00050 
<a name="l00053"></a>00053         <span class="keywordtype">void</span> <a class="code" href="class_experiment_timer.html#a77a4c5d514f5b57ef5f53ca6f5d8194f" title="The timeout Signal.">triggeredTimerLoopInvoked</a>();
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="keyword">public</span>:
<a name="l00056"></a>00056         <a class="code" href="class_experiment_timer.html" title="The ExperimentTimer class.">ExperimentTimer</a>(QObject *parent = NULL);
<a name="l00057"></a>00057         <a class="code" href="class_experiment_timer.html" title="The ExperimentTimer class.">ExperimentTimer</a>(<span class="keyword">const</span> <a class="code" href="class_experiment_timer.html" title="The ExperimentTimer class.">ExperimentTimer</a>&amp; other ){Q_UNUSED(other);};<span class="comment">//TODO fill in copy constructor, should be declared for the Q_DECLARE_METATYPE macro</span>
<a name="l00058"></a>00058         ~<a class="code" href="class_experiment_timer.html" title="The ExperimentTimer class.">ExperimentTimer</a>();
<a name="l00059"></a>00059 
<a name="l00060"></a>00060         <span class="keyword">static</span> QScriptValue ctor__experimentTimer(QScriptContext* context, QScriptEngine* engine);
<a name="l00061"></a>00061 
<a name="l00062"></a>00062         <span class="keyword">static</span> <span class="keywordtype">bool</span> SleepMSecAccurate_old(<span class="keywordtype">double</span> mSecs);
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 <span class="keyword">public</span> slots:
<a name="l00065"></a>00065         <span class="keywordtype">bool</span> makeThisAvailableInScript(QString strObjectScriptName = <span class="stringliteral">&quot;&quot;</span>, QObject *engine = NULL);<span class="comment">//To make the objects (e.g. defined in a *.exml file) available in the script</span>
<a name="l00066"></a>00066 
<a name="l00071"></a>00071         <span class="keywordtype">void</span> <a class="code" href="class_experiment_timer.html#aac042bba6c3d51a1c854f149ae305203" title="Starts the internal timer in the ExperimentTimer that keeps track of the elapsed time. This function starts the internal timer in the ExperimentTimer for keeping track of the elapsed time. See also ExperimentTimer.getElapsedTime(), ExperimentTimer.restart(), ExperimentTimer.stop().">start</a>();                                                                   <span class="comment">// start timer</span>
<a name="l00076"></a>00076 <span class="comment"></span>        <span class="keywordtype">void</span> <a class="code" href="class_experiment_timer.html#ad59bdbf085fd1b89d61d858dea25393d" title="Stops the internal timer in the ExperimentTimer that keeps track of the elapsed time. This function stops the internal timer in the ExperimentTimer for keeping track of the elapsed time. See also ExperimentTimer.getElapsedTime(), ExperimentTimer.restart(), ExperimentTimer.start().">stop</a>();                                                                    <span class="comment">// stop the timer</span>
<a name="l00081"></a>00081 <span class="comment"></span>        <span class="keywordtype">void</span> <a class="code" href="class_experiment_timer.html#a5573a1b658e3be3da0bad6e5d4a2d72c" title="Restarts the internal timer in the ExperimentTimer that keeps track of the elapsed time...">restart</a>();                                                                 <span class="comment">// restart the timer</span>
<a name="l00083"></a>00083 <span class="comment"></span>        <span class="keywordtype">double</span> <a class="code" href="class_experiment_timer.html#abfd43e259c74973bb41ae017389d2024" title="See ExperimentTimer.getElapsedTimeInSec()">getElapsedTime</a>();                                                <span class="comment">// get elapsed time in seconds</span>
<a name="l00088"></a>00088 <span class="comment"></span>        <span class="keywordtype">double</span> <a class="code" href="class_experiment_timer.html#a4d42aaf67576361638eb9cc85ca7e6e0" title="Returns the elapsed time since the internal timer was started in seconds. This function returns the e...">getElapsedTimeInSec</a>();                                   <span class="comment">// get elapsed time in second (same as getElapsedTime)</span>
<a name="l00093"></a>00093 <span class="comment"></span>        <span class="keywordtype">double</span> <a class="code" href="class_experiment_timer.html#a1bc4d0d4762d596789d8c202f608007b" title="Returns the elapsed time since the internal timer was started in milli-seconds. This function returns...">getElapsedTimeInMilliSec</a>();                              <span class="comment">// get elapsed time in milli seconds</span>
<a name="l00098"></a>00098 <span class="comment"></span>        <span class="keywordtype">double</span> <a class="code" href="class_experiment_timer.html#a64823414074d5942eab5ec0195c7583d" title="Returns the elapsed time since the internal timer was started in micro-seconds. This function returns...">getElapsedTimeInMicroSec</a>();                              <span class="comment">// get elapsed time in micro-second</span>
<a name="l00104"></a>00104 <span class="comment"></span>        <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="class_experiment_timer.html#affa748074913dbee9dd8b622c0f19ccf" title="Makes the current thread go to sleep accurately for a specified amount of time. This function makes t...">SleepMSecAccurate</a>(<span class="keywordtype">double</span> mSecs);
<a name="l00105"></a>00105 
<a name="l00111"></a>00111         <span class="keywordtype">void</span> <a class="code" href="class_experiment_timer.html#a7540fa5b15b731ae6bd87667881807d8" title="Starts the ExperimentTimer at a periodic interval time. This function starts the Experiment Timer and...">startTriggeredTimerLoop</a>(<span class="keywordtype">double</span> nIntervalTimeMSecs);
<a name="l00116"></a>00116         <span class="keywordtype">void</span> <a class="code" href="class_experiment_timer.html#a39f7c892da81cf863f4c5e766ca9fea5" title="Stops the running periodic interval thread from the ExperimentTimer. This function stops the running ...">stopTriggeredTimerLoop</a>();
<a name="l00117"></a>00117 
<a name="l00118"></a>00118 <span class="keyword">private</span>:
<a name="l00119"></a>00119         QScriptEngine* currentScriptEngine;
<a name="l00120"></a>00120 
<a name="l00121"></a>00121         <span class="keywordtype">double</span> startTimeInMicroSec;                                             <span class="comment">// starting time in micro-second</span>
<a name="l00122"></a>00122         <span class="keywordtype">double</span> endTimeInMicroSec;                                               <span class="comment">// ending time in micro-second</span>
<a name="l00123"></a>00123         <span class="keywordtype">int</span>    stopped;                                                                 <span class="comment">// stop flag </span>
<a name="l00124"></a>00124 <span class="preprocessor">#ifdef WIN32</span>
<a name="l00125"></a>00125 <span class="preprocessor"></span>        LARGE_INTEGER frequency;                                                <span class="comment">// ticks per second</span>
<a name="l00126"></a>00126         LARGE_INTEGER startCount;                   
<a name="l00127"></a>00127         LARGE_INTEGER endCount;                     
<a name="l00128"></a>00128 <span class="preprocessor">#else</span>
<a name="l00129"></a>00129 <span class="preprocessor"></span>        timeval startCount;                         
<a name="l00130"></a>00130         timeval endCount;                           
<a name="l00131"></a>00131 <span class="preprocessor">#endif</span>
<a name="l00132"></a>00132 <span class="preprocessor"></span>
<a name="l00133"></a>00133         <span class="keywordtype">bool</span> terminateTriggeredTimerLoop;
<a name="l00134"></a>00134         
<a name="l00135"></a>00135 };
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 <span class="preprocessor">#endif // EXPERIMENTTIMER_H</span>
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Tue Jul 14 2015 15:14:03 for ExperimentManager script class by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.0
</small></address>

</body>
</html>
